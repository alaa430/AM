<!DOCTYPE html>
<html manifest="cache.manifest">
<head>
<title>PS4 5.05 FW GoldHEN ALAA MOHAMED 01001550618</title>
<link rel="stylesheet" href="../style.css">
<script src="exploit.js"></script>
</head>
<body onload="if(localStorage.cached505=='yes')setTimeout(exploit, 50);">
<script>
window.applicationCache.onprogress=function(a){document.getElementById("msgs2").innerHTML="Installing Offline Cache: "+(Math.round(100*(a.loaded/a.total)))+"%"};
window.applicationCache.oncached=function(){setTimeout(function(){document.getElementById("msgs2").innerHTML="Cache Installed Successfully ✔";},1500);setTimeout(function(){document.getElementById("msgs2").innerHTML="Now Close And Re-Open Your Browser ..."; },3500);localStorage.cached505="yes";};
window.applicationCache.onnoupdate=function(){localStorage.cached505="yes";};
window.applicationCache.onerror=function(){localStorage.cached505="yes";};
</script>
<h1 id="msgs">PS4 5.05 FW GoldHEN ALAA MOHAMED 01001550618</h1>
<hr>
<!DOCTYPE html>
<html>
<head>
<style> 
div {
  width: 100px;
  height: 100px;
  background: red;
  position: relative;
  animation: mymove 5s infinite;
}

@keyframes mymove {
  0%   {top: 0px; left: 1900px; background: red;}
  20%  {top: 0px; left: 500px; background: blue;}
  50%  {top: 100px; left: 1200px; background: yellow;}
  75%  {top: 100px; left: 500px; background: green;}
  100% {top: 0px; left: 1200px; background: red;}
}
</style>
</head>
<body>
</html>
<br>
<div id="div1"><h1 id="msgs2" style="font-size: 30px;margin-top: 77px;margin-bottom: 455px;"> انتظر شويه </h1>
<script>
function allset(){
msgs2.innerHTML = LoadedMSG
}

function load_payload(){
req1=null;
var req1=new XMLHttpRequest();
req1.open('GET',PLfile);req1.responseType="arraybuffer";
req1.send();
 req1.onreadystatechange=function(){
  if (req1.readyState==4){
   var padding1=new Uint8Array(4 - (req1.response.byteLength % 4) % 4);
   var tmp1=new Uint8Array(req1.response.byteLength + padding1.byteLength);
   tmp1.set(new Uint8Array(req1.response),0);
   tmp1.set(padding1,req1.response.byteLength);
   var shellcode1=new Uint32Array(tmp1.buffer);
   var code_addr1=new int64(0x26100000,0x00000009);
   p.syscall(477,code_addr1,0x300000,7,0x41000,-1,0);
    for(var i=0;i < shellcode1.length; i++){
	p.write4(code_addr1.add32(0x100000 + i * 4),shellcode1[i]);
	}
   runPAYLOAD1=function(){
   p.fcall(code_addr1);
   PLfile=null;
    for(var x=0;x < 0x300000;x += 8){
	p.write8(code_addr1.add32(x),0);}
	};
	allset();
   setTimeout(runPAYLOAD1,100);
  }
 };
}

function success(){
LoadedMSG = "<h1 style='font-size:30px;'>GoldHEN v2.4b17.3 Loaded تم تفعيل التعديل بنجاح</h1>";
PLfile = "goldhen_2.4b17.3.bin";
load_payload();
}
</script>
</body>
</html>
